<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>后端系统架构图</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
    <style>
        body {
            font-family: 'Microsoft YaHei', '微软雅黑', sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
            background-color: #f5f5f5;
        }
        .container {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            padding: 20px;
            width: 90%;
            max-width: 1200px;
        }
        h1 {
            text-align: center;
            color: #333;
        }
        .mermaid {
            display: flex;
            justify-content: center;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>后端系统架构图</h1>
        <div class="mermaid">
            graph TD
                客户端(客户端) --> |HTTP请求| 负载均衡[负载均衡器]
                负载均衡 --> |分发请求| API网关[API网关]
                
                API网关 --> |鉴权| 认证授权[认证/授权服务]
                API网关 --> |路由请求| 控制器[控制器层]
                
                认证授权 --> |返回令牌| API网关
                认证授权 --> |验证用户| 用户存储[用户数据库]
                
                控制器 --> |处理请求| 业务逻辑[业务逻辑层]
                业务逻辑 --> |读写数据| 数据访问[数据访问层]
                业务逻辑 --> |发送消息| 消息队列[消息队列]
                业务逻辑 --> |缓存数据| 缓存层[缓存层]
                
                数据访问 --> |查询/更新| 数据库[数据库]
                数据访问 --> |读取缓存| 缓存层
                
                消息队列 --> |消息处理| 后台任务[后台任务/工作者]
                后台任务 --> |处理结果| 数据访问
                
                业务逻辑 --> |调用外部服务| 外部集成[外部服务集成]
                外部集成 --> |获取数据| 第三方[第三方服务]
                
                subgraph 服务器层
                    API网关
                    认证授权
                    控制器
                    业务逻辑
                    数据访问
                    消息队列
                end
                
                subgraph 数据存储层
                    数据库
                    缓存层
                    用户存储
                end
                
                subgraph 基础设施层
                    负载均衡
                    CDN[内容分发网络]
                    监控[日志/监控系统]
                end
                
                后台任务 --> |写入日志| 监控
                API网关 --> |静态资源| CDN
                业务逻辑 --> |记录日志| 监控
                
                classDef primary fill:#b9f,stroke:#333,stroke-width:2px;
                classDef secondary fill:#9cf,stroke:#333,stroke-width:1px;
                classDef tertiary fill:#bbf9a3,stroke:#333,stroke-width:1px;
                classDef infra fill:#fcba03,stroke:#333,stroke-width:1px;
                
                class API网关,控制器,认证授权 primary;
                class 业务逻辑,数据访问,消息队列,后台任务,外部集成 secondary;
                class 数据库,缓存层,用户存储,第三方 tertiary;
                class 负载均衡,CDN,监控 infra;
        </div>
    </div>

    <script>
        mermaid.initialize({
            startOnLoad: true,
            theme: 'default',
            flowchart: {
                useMaxWidth: false,
                htmlLabels: true,
                curve: 'basis'
            }
        });
    </script>
</body>
</html> 